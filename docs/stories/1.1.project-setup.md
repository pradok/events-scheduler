# Story 1.1: Project Setup & Monorepo Foundation

---

## Status

**Draft**

---

## Story

**As a** developer,
**I want** a properly configured TypeScript monorepo with build tooling and code quality enforcement,
**so that** the project has a solid foundation for development with consistent code standards.

---

## Acceptance Criteria

1. Repository initialized with Git, .gitignore configured for Node.js/TypeScript
2. package.json configured with npm workspaces for monorepo structure
3. TypeScript 5.3.3 installed with strict mode enabled in tsconfig.json (zero `any` types allowed)
4. ESLint 8.56.0 and Prettier 3.2.5 configured and enforced
5. Build scripts configured using esbuild 0.20.0 for fast compilation
6. Pre-commit hooks configured to run linting and formatting
7. README.md created with project overview and setup instructions
8. All code passes linting with 0 errors and <10 warnings

---

## Tasks / Subtasks

- [ ] **Task 1: Initialize Git repository and configure .gitignore** (AC: 1)
  - [ ] Run `git init` if not already initialized
  - [ ] Create `.gitignore` file with Node.js/TypeScript patterns
  - [ ] Add entries for: `node_modules/`, `dist/`, `.env`, `coverage/`, `*.log`

- [ ] **Task 2: Create root package.json with npm workspaces** (AC: 2)
  - [ ] Initialize package.json with project metadata
  - [ ] Configure `"workspaces": []` field (prepared for future packages)
  - [ ] Set Node.js version requirement: `"engines": { "node": "20.11.0" }`
  - [ ] Pin all dependency versions (no `^` or `~` ranges)

- [ ] **Task 3: Install and configure TypeScript 5.3.3** (AC: 3)
  - [ ] Install TypeScript 5.3.3 as dev dependency with exact version
  - [ ] Create `tsconfig.json` with strict mode enabled
  - [ ] Configure compiler options: `"strict": true`, `"noImplicitAny": true`, `"strictNullChecks": true`
  - [ ] Set `"target": "ES2022"`, `"module": "ESNext"`, `"moduleResolution": "node"`
  - [ ] Configure paths: `"outDir": "./dist"`, `"rootDir": "./src"`
  - [ ] Add `"include": ["src/**/*"]`, `"exclude": ["node_modules", "dist", "**/*.test.ts"]`

- [ ] **Task 4: Install and configure ESLint 8.56.0 and Prettier 3.2.5** (AC: 4)
  - [ ] Install ESLint 8.56.0 and TypeScript ESLint parser/plugin
  - [ ] Install Prettier 3.2.5 and eslint-config-prettier
  - [ ] Create `.eslintrc.js` with TypeScript rules
  - [ ] Add ESLint rule: forbid `console.log` in `src/` directory
  - [ ] Add ESLint rule: forbid `any` type
  - [ ] Create `.prettierrc` with formatting config (2 spaces, single quotes, semicolons)
  - [ ] Add npm scripts: `"lint": "eslint src --ext .ts"`, `"format": "prettier --write 'src/**/*.ts'"`

- [ ] **Task 5: Configure esbuild 0.20.0 for compilation** (AC: 5)
  - [ ] Install esbuild 0.20.0 as dev dependency
  - [ ] Create build script in `package.json`: `"build": "esbuild src/index.ts --bundle --platform=node --outfile=dist/index.js --sourcemap"`
  - [ ] Add watch script: `"build:watch": "esbuild src/index.ts --bundle --platform=node --outfile=dist/index.js --sourcemap --watch"`
  - [ ] Test build runs successfully (even with placeholder src/index.ts)

- [ ] **Task 6: Configure pre-commit hooks** (AC: 6)
  - [ ] Install husky for git hooks
  - [ ] Install lint-staged for running linters on staged files
  - [ ] Configure husky pre-commit hook to run lint-staged
  - [ ] Configure lint-staged to run ESLint and Prettier on `*.ts` files
  - [ ] Test pre-commit hook triggers on git commit

- [ ] **Task 7: Create comprehensive README.md** (AC: 7)
  - [ ] Add project title and description (Time-Based Event Scheduling System)
  - [ ] Add setup instructions: Node.js version, npm install, environment setup
  - [ ] Document available npm scripts: build, lint, format, test
  - [ ] Add architecture overview (Hexagonal Architecture, DDD)
  - [ ] Include tech stack summary from architecture docs
  - [ ] Add development workflow instructions

- [ ] **Task 8: Verify linting passes with 0 errors** (AC: 8)
  - [ ] Run `npm run lint` and ensure 0 errors
  - [ ] Ensure warnings count is <10
  - [ ] Fix any linting issues in placeholder code
  - [ ] Verify TypeScript compilation succeeds with strict mode

---

## Dev Notes

### Tech Stack Configuration

**Source:** [docs/architecture/tech-stack.md](../../architecture/tech-stack.md)

**Core Technologies:**
- **TypeScript**: 5.3.3 (strict mode mandatory)
- **Node.js**: 20.11.0 LTS
- **Build Tool**: esbuild 0.20.0 (fast TypeScript compilation for Lambda bundling)
- **Linting**: ESLint 8.56.0 with TypeScript rules
- **Formatting**: Prettier 3.2.5
- **Monorepo Tool**: npm workspaces (native npm feature, no additional tools)

**Version Pinning Strategy:**
- All versions must be pinned to exact versions (no `^` or `~` ranges)
- Use exact versions in package.json for reproducibility
- Node.js 20.11.0 LTS chosen for stability (not 21.x)

**Key Technology Decisions Rationale:**
- esbuild chosen for fast TypeScript compilation and Lambda bundling
- npm workspaces for monorepo (no need for Lerna/Nx in Phase 1)
- TypeScript strict mode enforces code quality from day one

### Project Structure

**Source:** [docs/architecture/source-tree.md](../../architecture/source-tree.md)

**Root-Level Files to Create:**
- `.gitignore` - Node.js/TypeScript patterns
- `package.json` - Root package with workspaces config
- `tsconfig.json` - TypeScript configuration with strict mode
- `.eslintrc.js` - ESLint configuration
- `.prettierrc` - Prettier formatting rules
- `README.md` - Project documentation
- `.env.example` - Environment variable template (placeholder for now)

**Directory Structure (Initial Setup):**
```
bday/
├── .github/
│   └── workflows/           # (Story 1.10 - CI/CD Pipeline)
├── src/
│   └── index.ts            # Placeholder entry point
├── dist/                   # Build output (gitignored)
├── node_modules/           # Dependencies (gitignored)
├── .gitignore
├── package.json
├── tsconfig.json
├── .eslintrc.js
├── .prettierrc
├── README.md
└── .env.example
```

**Import Rules to Enforce:**
- Domain layer (`src/domain/`) must have zero external dependencies
- Application layer can import domain entities only
- Adapter layer can import external frameworks
- These rules will be enforced via ESLint plugins in later stories

### Coding Standards

**Source:** [docs/architecture/coding-standards.md](../../architecture/coding-standards.md)

**Critical Rules to Enforce:**

1. **No Console.log in Production**
   - ESLint must forbid `console.log` in `src/` directory
   - Exception: Test files can use console

2. **No `any` Types**
   - TypeScript strict mode enabled
   - ESLint rule: `@typescript-eslint/no-explicit-any: error`
   - Use `unknown` if type is truly unknown

3. **Naming Conventions** (to be enforced in code from this story forward):
   - Classes: PascalCase (e.g., `User`, `CreateUserUseCase`)
   - Interfaces (Ports): PascalCase with `I` prefix (e.g., `IUserRepository`)
   - Files: kebab-case for infrastructure, PascalCase for domain (e.g., `user.routes.ts`, `User.ts`)
   - Variables/Functions: camelCase (e.g., `calculateNextBirthday`)
   - Constants: UPPER_SNAKE_CASE (e.g., `MAX_RETRY_COUNT`)
   - Test Files: `*.test.ts` (e.g., `User.test.ts`)

**ESLint Configuration Requirements:**
- Extend `@typescript-eslint/recommended`
- Enable `strict` ruleset
- Forbid `console.log` (except in test files)
- Forbid `any` type
- Enforce consistent code style

**Prettier Configuration Requirements:**
- 2 spaces for indentation
- Single quotes for strings
- Semicolons required
- Trailing commas in ES5-compatible locations

### Testing Standards

**Source:** [docs/architecture/test-strategy.md](../../architecture/test-strategy.md)

**Test Organization:**
- Test files use `*.test.ts` naming convention
- Tests will be colocated with source OR in parallel `tests/` directory structure
- Unit tests in `tests/unit/` mirroring `src/` structure
- Integration tests in `tests/integration/`
- E2E tests in `tests/e2e/`

**Testing Framework:**
- Jest 29.7.0 (will be installed in later story)
- AAA pattern (Arrange, Act, Assert)
- Minimum 80% code coverage for domain and application layers

**For This Story:**
- No tests required yet (testing infrastructure added in later stories)
- Focus on setting up linting and build tooling

### Git Configuration

**Source:** Inferred from project status and coding standards

**Git Workflow:**
- Working directly on `main` branch (no feature branches for this project)
- Commit after each story implementation
- Pre-commit hooks run linting and formatting automatically

**.gitignore Patterns Required:**
```
# Dependencies
node_modules/

# Build output
dist/
*.js
*.d.ts
!jest.config.js
!.eslintrc.js

# Environment
.env
.env.local
.env.*.local

# Testing
coverage/
*.log

# IDE
.vscode/
.idea/
*.swp
*.swo

# OS
.DS_Store
Thumbs.db
```

### README.md Content Guidance

**Key Sections to Include:**

1. **Project Overview**
   - Time-Based Event Scheduling System (Birthday Messaging MVP)
   - Phase 1: Backend service only (no UI)
   - Architecture: Hexagonal Architecture + Domain-Driven Design

2. **Tech Stack**
   - Node.js 20.11.0 LTS
   - TypeScript 5.3.3
   - Fastify 4.26.0 (mention even though not installed yet)
   - PostgreSQL 16.1
   - AWS Lambda + EventBridge + SQS

3. **Getting Started**
   - Prerequisites: Node.js 20.11.0
   - Installation: `npm install`
   - Build: `npm run build`
   - Linting: `npm run lint`
   - Formatting: `npm run format`

4. **Project Structure**
   - Brief overview of hexagonal architecture layers
   - Mention domain, application, adapters separation

5. **Development Workflow**
   - How to run locally (Docker Compose in later story)
   - How to run tests (Jest in later story)
   - How to contribute (linting and formatting enforced via pre-commit hooks)

---

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-10-19 | 1.0 | Initial story creation | Scrum Master (Bob) |

---

## Dev Agent Record

*This section will be populated by the development agent during implementation.*

### Agent Model Used

*To be filled by Dev Agent*

### Debug Log References

*To be filled by Dev Agent*

### Completion Notes

*To be filled by Dev Agent*

### File List

*To be filled by Dev Agent*

---

## QA Results

*To be filled by QA Agent after implementation review*
